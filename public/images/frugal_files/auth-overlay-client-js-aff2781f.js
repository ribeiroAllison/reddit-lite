import"./shreddit-slotter-e2473c83.js";import"./faceplate-tabpanel-a0e14b2b.js";import"./auth-flow-modal-63162a15.js";import"./auth-text-input-fdef68d2.js";import"./auth-flow-sso-buttons-3753214c.js";import"./shreddit-signup-drawer-c754fcaf.js";import{a as t,_ as e,n as s,t as i,E as o,O as a,a5 as n,e as r,ay as l}from"./shell-10899a6f.js";import{S as h}from"./scroll-blocker-d0c6a89b.js";import{O as p,D as d}from"./constants-00f6edde.js";import{s as c,A as m,x as f,l as u}from"./icon-732d0443.js";import"./pageable-8c01eaad.js";import"./index-e0b6f10d.js";import"./contextualSignupPrompt-a6a423ee.js";import"./faceplate-text-input-acdf40f0.js";import"./live-79249cef.js";import"./text-input-f66f9653.js";import"./form-common-utils-0a9272bf.js";import"./faceplate-input-6d2f4135.js";import"./input-element-6687ec6f.js";import"./light-dom-slot-controller-4235c975.js";import"./auth-flow-controller-3f1196e3.js";import"./reload-to-logged-in-65de6d4f.js";import"./index-9c3b783f.js";import"./load-lazy-script-with-nonce-84299a7e.js";import"./with-recaptcha-defe1386.js";import"./onboarding-ca0f296e.js";import"./shreddit-overlay-4652e4d4.js";let g=l,b=window.location,j=class extends c{constructor(){super(...arguments),this.stepName=null,this.isStandalonePage=!1,this.open=!1,this.history=[],this.events=new o(this),this.scrollBlocker=new h(this),this.findStepElement=t=>this.querySelector(`[slot="${t}"]`),this.requestClose=()=>{this.blocking?this.isStandalonePage&&this.redirectToHome():this.close()},this.redirectToHome=()=>{b.href=location.origin},this.handleEscKey=this.events.define("keydown",(t=>{"Escape"!==t.key||this.blocking||this.close()})),this.onShredditSlot=this.events.define("shreddit-slotter-set-slot-name",(t=>{!t.defaultPrevented&&this.hasStep(t.detail.slotName)&&(t.preventDefault(),this.show(t.detail.slotName))})),this.handleDismissOverlay=this.events.define("dismiss-overlay",this.requestClose),this.handleAccountManagerDismissed=this.events.define("accountmanager-dismissed",this.requestClose),this.deprecated__onFaceplateTrack=this.events.define("faceplate-track",(t=>{const{source:e,action:s,noun:i}=t.detail;e===p&&s===d&&a.has(i)&&this.requestClose()}))}get blocking(){if(this.isStandalonePage)return!0;if(this.open&&this.stepName){return!!this.findStepElement(this.stepName)?.getAttribute("blocking")}return!1}connectedCallback(){super.connectedCallback(),null!==this.stepName&&this.show(this.stepName)}hasStep(t){return!!this.findStepElement(t)}async show(t,e){const s=this.findStepElement(t),i=s?.getAttribute("feature-name");if(!s||!i)return!1;try{await g({root:s,name:i,renderMode:n.Contents,...e,queryParams:{...e?.queryParams,is_standalone:this.isStandalonePage}})}finally{this.open=!0,this.history.push(t),this.stepName=t,this.scrollBlocker.blockPageScrolling()}return!0}back(){if(!this.open)return;this.history.pop();const t=this.history.at(-1);if(!t)return this.requestClose();this.stepName=t}close(){this.open=!1,this.stepName=null,this.history=[],this.scrollBlocker.unblockPageScrolling()}render(){return this.open?f`\n <div class="z-[100] fixed">\n <div \n class="${u(this.isStandalonePage?void 0:"fixed top-0 right-0 bottom-0 left-0 bg-black opacity-50 backdrop-blur-sm")}" \n tabindex="-1" \n @click="${this.requestClose}" \n></div>\n <slot name="${this.stepName}"></slot>\n <slot></slot>\n </div>\n `:m}};j.styles=[t],e([s({attribute:"step-name",type:String,reflect:!0})],j.prototype,"stepName",void 0),e([s({attribute:"is-standalone",type:Boolean})],j.prototype,"isStandalonePage",void 0),e([i()],j.prototype,"open",void 0),j=e([r("auth-flow-manager")],j);
//# sourceMappingURL=auth-overlay-client-js-aff2781f.js.map
